import time
import requests
from selenium import webdriver
keywords=["female",'women',"sexism"]
weburl="https://www.wsj.com/search?query={word}&page={page}"
executable_path='/Users/gavin/opt/anaconda3/chromedriver'
options=webdriver.ChromeOptions()
options.add_argument('--headless')
driver=webdriver.Chrome(options=options,executable_path=executable_path)
for word in keywords:
    file=open(f"wsj_{word}",'w',encoding="utf-8")
    page=1
    while True:
        url=weburl.format(word=keywords, page=page)
        driver.get(url)
        time.sleep(5)
        line=driver.find_elements_by_xpath("//article//h3/a")
        if len(line)==0:
            break
        print(f"keyword:{word} page:{page}")
        for e in line:
            headline=e.text
            file.write(headline+"\n")
            file.flush()
        page+=1
driver.quit()
